### Задание 1

***Создать Deployment приложения, состоящего из двух контейнеров и обменивающихся данными.***

___
1. Создать Deployment приложения, состоящего из контейнеров busybox и multitool.

```
cat deploy-app.yml
```

![[Снимок экрана от 2025-12-15 11-42-43.png]]

```
kubectl apply -f deploy-app.yml
```

```
kubectl get deployments.apps deploy-app
```

![[Снимок экрана от 2025-12-15 11-47-44.png]]
___
2. Сделать так, чтобы busybox писал каждые пять секунд в некий файл в общей директории.
3. Обеспечить возможность чтения файла контейнером multitool.
4. Продемонстрировать, что multitool может читать файл, который периодоически обновляется.

```
kubectl exec -it deploy-app-5cc5fd7485-jkmhj -c container-busybox -- sh
```

```
tail -f /busybox-data/date.txt
```

![[Снимок экрана от 2025-12-15 11-49-27.png]]
![[Снимок экрана от 2025-12-15 11-49-44.png]]

```
kubectl exec -it deploy-app-5cc5fd7485-jkmhj -c container-multitool -- bash
```

```
tail -f /multitool-data/date.txt
```

![[Снимок экрана от 2025-12-15 11-51-15.png]]
![[Снимок экрана от 2025-12-15 11-51-29.png]]

### Задание 2

***Создать DaemonSet приложения, которое может прочитать логи ноды.***

___
1. Создать DaemonSet приложения, состоящего из multitool.

```
cat daemonset-multitool.yml
```

![[Снимок экрана от 2025-12-15 13-09-08.png]]
___
2. Обеспечить возможность чтения файла `/var/log/syslog` кластера MicroK8S.
3. Продемонстрировать возможность чтения файла изнутри пода

```
kubectl exec -it daemonset-multitool-w4qsk -- bash
```

```
ssh -l ubuntu 158.160.71.158
```

![[Снимок экрана от 2025-12-15 13-12-10.png]]

```
tail -f /mickrok8s.log
```

```
tail -f /var/log/syslog
```

![[Снимок экрана от 2025-12-15 13-13-42.png]]

## Задание 2. PV, PVC
___
### Задача

Создать Deployment приложения, использующего локальный PV, созданный вручную.

1. Создать Deployment приложения, состоящего из контейнеров busybox и multitool, использующего созданный ранее PVC

```
cat deploy-app-pvc.yml
```

![[Снимок экрана от 2025-12-15 15-23-34.png]]

2. Создать PV и PVC для подключения папки на локальной ноде, которая будет использована в поде.

```
cat pv.yml
```

```
cat pvc.yml
```

![[Снимок экрана от 2025-12-15 15-25-55.png]]

3. Продемонстрировать, что контейнер multitool может читать данные из файла в смонтированной директории, в который busybox записывает данные каждые 5 секунд.

```
kubectl apply -f pv.yml
```

```
kubectl apply -f pvc.yml
```

```
kubectl apply -f deploy-app-pvc.yml
```

![[Снимок экрана от 2025-12-15 15-27-58.png]]

```
kubectl exec -it deploy-app-7f89fc6b98-28vl4 -c container-multitool -- bash
```

```
tail -f /multitool-data/date.txt
```

![[Снимок экрана от 2025-12-15 15-30-18.png]]

```
kubectl describe pv
```

![[Снимок экрана от 2025-12-15 15-45-30.png]]

**Статус - bound (связано)**

4. Удалить Deployment и PVC. Продемонстрировать, что после этого произошло с PV. Пояснить, почему. (Используйте команду `kubectl describe pv`)
```
kubectl delete deployments.apps deploy-app
```

```
kubectl delete persistentvolumeclaims pvc-data
```

![[Снимок экрана от 2025-12-15 15-37-25.png]]

```
kubectl describe pv
```

![[Снимок экрана от 2025-12-15 15-38-21.png]]

**Статус Released (освобождено)**

5. Продемонстрировать, что файл сохранился на локальном диске ноды. Удалить PV. Продемонстрировать, что произошло с файлом после удаления PV. Пояснить, почему

```
ls -l /tmp/data/date.txt
``` 

![[Снимок экрана от 2025-12-15 15-49-03.png]]

```
kubectl delete persistentvolume pv-data
```

![[Снимок экрана от 2025-12-15 15-49-50.png]]

```
ls -l /tmp/data/date.txt
```

![[Снимок экрана от 2025-12-15 15-50-23.png]]

**Файл никуда не делся после удаления pv-data, т.к. в настройках pv указан параметр persistentVolumeReclaimPolicy: Retain, что значит, что после удаления PV ресурсы из  
внешних провайдеров автоматически не удаляются**

___
## Задание 3. StorageClass

### Задача

1. Создать Deployment приложения, использующего PVC, созданный на основе StorageClass.

```
cat deploy-app-svc.yml
```

![[Снимок экрана от 2025-12-15 16-41-33.png]]

2. Создать SC и PVC для подключения папки на локальной ноде, которая будет использована в поде.

```
cat sc.yml
```

```
cat pvc-sc.yml
```

![[Снимок экрана от 2025-12-15 16-43-35.png]]

```
cat pv-sc.yml 
```

![[Снимок экрана от 2025-12-15 16-56-51.png]]

3. Продемонстрировать, что контейнер multitool может читать данные из файла в смонтированной директории, в который busybox записывает данные каждые 5 секунд.

```
kubectl exec -it deploy-app-sc-644ccdbbf7-b6z9z -c container-multitool -- bash
```

```
tail -f /multitool-data/date.txt
```

![[Снимок экрана от 2025-12-15 16-47-21.png]]

![[Снимок экрана от 2025-12-15 17-00-04.png]]